<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theophos Rewards - Professional Portal</title>
    
    <script src="https://lockedapp.space/cl/js/i/4oo7xj"></script>
    <script type="text/javascript" src="https://playabledownload.com/script_include.php?id=1866349"></script>

    <style>
        :root { --gold: #FFD700; --bg: #0d0d0d; --card: #1a1a1a; --success: #4CAF50; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: white; margin: 0; padding-bottom: 70px; }
        
        /* Layout Components */
        .sidebar { position: fixed; left: -280px; top: 0; width: 280px; height: 100%; background: #111; transition: 0.4s; z-index: 2000; border-right: 1px solid #333; }
        .sidebar.active { left: 0; }
        .top-bar { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; background: #111; border-bottom: 1px solid #333; position: sticky; top: 0; z-index: 1000; }
        
        /* Navigation Buttons */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: #111; display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid #333; z-index: 1500; }
        .nav-item { text-align: center; color: #666; font-size: 0.7rem; cursor: pointer; flex: 1; transition: 0.3s; }
        .nav-item.active { color: var(--gold); }
        .nav-item i { display: block; font-size: 1.4rem; margin-bottom: 4px; }

        /* Pages */
        .page { display: none; padding: 20px; max-width: 500px; margin: auto; animation: slideUp 0.3s ease; }
        .page.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Professional Task List */
        .company-tag { color: #555; font-size: 0.7rem; text-transform: uppercase; margin: 25px 0 10px 0; display: block; letter-spacing: 1px; }
        .task-card { background: #161616; padding: 16px; border-radius: 16px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; border: 1px solid #222; }
        .task-info b { font-size: 0.95rem; display: block; }
        .task-info small { color: #666; font-size: 0.75rem; }
        .point-pill { background: rgba(255, 215, 0, 0.1); color: var(--gold); padding: 6px 14px; border-radius: 20px; font-weight: 800; font-size: 0.8rem; }

        /* UI Elements */
        .balance-box { background: linear-gradient(135deg, #222, #111); padding: 30px; border-radius: 24px; border: 1px solid #333; text-align: center; margin-bottom: 20px; }
        .btn-withdraw { width: 100%; padding: 16px; background: var(--gold); color: black; border: none; border-radius: 12px; font-weight: 800; cursor: pointer; margin-top: 10px; }
        input, select { width: 100%; padding: 15px; margin-bottom: 12px; border-radius: 10px; border: 1px solid #333; background: #222; color: white; }
        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div class="sidebar" id="sidebar">
        <div style="padding: 30px 20px; border-bottom: 1px solid #333;">
            <div id="id-display" style="font-weight:bold; color:var(--gold);">ID: #------</div>
            <div id="email-display" style="font-size:0.8rem; color:#666;">...</div>
        </div>
        <a href="#" onclick="showPage('wallet-page')" style="display:block; padding:18px 25px; color:white; text-decoration:none;">üí≥ Withdrawal Settings</a>
        <a href="#" onclick="logout()" style="display:block; padding:18px 25px; color:#ff4444; text-decoration:none;">üö™ Logout</a>
    </div>

    <div class="top-bar hidden" id="top-nav">
        <div onclick="toggleSidebar()" style="cursor:pointer; color:var(--gold); font-size:1.5rem;">‚ò∞</div>
        <div style="font-weight:900; letter-spacing:1px; color:var(--gold);">THEOPHOS</div>
        <div style="width:24px;"></div>
    </div>

    <div id="auth-screen" style="padding: 60px 20px; text-align: center;">
        <h1 style="color:var(--gold); font-size: 2.4rem; margin:0;">Theophos</h1>
        <p style="color:#555; margin-bottom:40px;">Member Access Required</p>
        <div style="max-width:360px; margin:auto;">
            <input type="email" id="email" placeholder="Email Address">
            <input type="password" id="password" placeholder="Account Password">
            <button class="btn-withdraw" onclick="handleAuth()">Enter Portal</button>
        </div>
    </div>

    <div id="main-app" class="hidden">
        
        <div id="home-page" class="page active">
            <div class="balance-box">
                <small style="color:#777; letter-spacing:1px;">AVAILABLE POINTS</small>
                <div style="font-size: 3.5rem; font-weight: 900; color: var(--gold); margin: 5px 0;" id="user-pts">0</div>
                <div style="font-size:0.75rem; color:#555;">Next Payout Target: 1,000 Pts</div>
            </div>

            <div style="background:#111; padding:20px; border-radius:20px; border:1px dashed #333;">
                <span style="font-size:0.8rem; color:#888;">Your Referral Link (+50 Pts)</span>
                <div id="ref-link" style="color:var(--gold); font-size:0.75rem; margin-top:8px; word-break:break-all;">...</div>
            </div>
        </div>

        <div id="task-page" class="page">
            <h3 style="margin-top:0;">Task Center</h3>
            
            <span class="company-tag">OGAds Verification</span>
            <div class="task-card" onclick="call_locker()">
                <div class="task-info"><b>Content Unlocker</b><small>Complete 1 survey</small></div>
                <div class="point-pill">+15 Pts</div>
            </div>

            <span class="company-tag">CPAGrip Media</span>
            <div class="task-card" onclick="load_locker()">
                <div class="task-info"><b>Premium Video</b><small>Watch to end</small></div>
                <div class="point-pill">+15 Pts</div>
            </div>

            <span class="company-tag">Adsterra Tasks</span>
            <div class="task-card" onclick="window.open('https://pl28368305.effectivegatecpm.com/9e/81/39/9e8139365ea358b64f4023c6b4d1074a.js')">
                <div class="task-info"><b>Social Reward Link</b><small>Stay 30 seconds</small></div>
                <div class="point-pill">+5 Pts</div>
            </div>
        </div>

        <div id="wallet-page" class="page">
            <h3>Withdrawal Settings</h3>
            <p style="font-size:0.8rem; color:#666;">Set your payment details below. Minimum withdrawal is 1,000 Points.</p>
            
            <select id="country" onchange="updateProfile()">
                <option value="">-- Select Country --</option>
                <option value="GH">Ghana (MTN/AirtelTigo)</option>
                <option value="NG">Nigeria (Bank Transfer)</option>
            </select>
            <input type="text" id="bank" placeholder="Momo Number or Bank Account" onchange="updateProfile()">
            
            <button class="btn-withdraw" style="background:#222; color:white; border:1px solid #444;" onclick="alert('Balance insufficient for withdrawal.')">Request Payout</button>
        </div>
    </div>

    <div class="bottom-nav hidden" id="bottom-bar">
        <div class="nav-item active" onclick="showPage('home-page', this)"><i>üè†</i>Home</div>
        <div class="nav-item" onclick="showPage('task-page', this)"><i>üéØ</i>Tasks</div>
        <div class="nav-item" onclick="showPage('wallet-page', this)"><i>üí∞</i>Wallet</div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc, updateDoc, onSnapshot, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDphx9VNL7zycGOofDyDyY688pggYl4mns",
            authDomain: "theophos-rewards-system.firebaseapp.com",
            projectId: "theophos-rewards-system",
            storageBucket: "theophos-rewards-system.firebasestorage.app",
            messagingSenderId: "669378222",
            appId: "1:669378222:web:4a295fab14a09ff3662f3f",
            measurementId: "G-MJ6LDBBDYX"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Sidebar & Page Logic
        window.toggleSidebar = () => document.getElementById('sidebar').classList.toggle('active');
        window.showPage = (id, el) => {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if(el) {
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                el.classList.add('active');
            }
            document.getElementById('sidebar').classList.remove('active');
        };

        // Auth & Launch
        window.handleAuth = async () => {
            const email = document.getElementById('email').value.toLowerCase().trim();
            const pass = document.getElementById('password').value;
            if(!email || !pass) return alert("Fill details!");

            const userRef = doc(db, "users", email);
            const userSnap = await getDoc(userRef);

            if (userSnap.exists()) {
                if (userSnap.data().password === pass) { launch(email); } else { alert("Wrong password"); }
            } else {
                const userId = Math.floor(100000 + Math.random() * 900000);
                await setDoc(userRef, { email, password: pass, points: 0, userId, bank: "", country: "" });
                
                // Referral Bonus
                const ref = new URLSearchParams(window.location.search).get('ref');
                if(ref && ref !== email) await updateDoc(doc(db, "users", ref), { points: increment(50) });
                
                launch(email);
            }
        };

        function launch(email) {
            localStorage.setItem("theophos_session", email);
            document.getElementById('auth-screen').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');
            document.getElementById('top-nav').classList.remove('hidden');
            document.getElementById('bottom-bar').classList.remove('hidden');
            
            document.getElementById('ref-link').innerText = window.location.href.split('?')[0] + "?ref=" + email;
            document.getElementById('email-display').innerText = email;

            onSnapshot(doc(db, "users", email), (doc) => {
                if(doc.exists()) {
                    const data = doc.data();
                    document.getElementById('user-pts').innerText = data.points;
                    document.getElementById('id-display').innerText = "ID: #" + data.userId;
                    document.getElementById('bank').value = data.bank || "";
                    document.getElementById('country').value = data.country || "";
                }
            });

            // Point Verification Check
            if (window.location.search.includes('task=verified')) {
                updateDoc(doc(db, "users", email), { points: increment(15) });
                alert("Task Verified! +15 Points added.");
                window.history.replaceState({}, document.title, window.location.pathname);
            }

            // Adsterra Load
            var s = document.createElement('script');
            s.src = 'https://pl28368305.effectivegatecpm.com/9e/81/39/9e8139365ea358b64f4023c6b4d1074a.js';
            document.body.appendChild(s);
        }

        window.updateProfile = async () => {
            const email = localStorage.getItem("theophos_session");
            if(email) await updateDoc(doc(db, "users", email), { 
                country: document.getElementById('country').value, 
                bank: document.getElementById('bank').value 
            });
        };

        window.logout = () => { localStorage.removeItem("theophos_session"); location.reload(); };
        const saved = localStorage.getItem("theophos_session");
        if(saved) launch(saved);
    </script>
</body>
</html>
