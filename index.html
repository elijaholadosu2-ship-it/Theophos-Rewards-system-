<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theophos Rewards</title>
    
    <script type="text/javascript" src="https://applocked.store/cp/js/kpp1r"></script> <script src="https://lockedapp.space/cl/js/i/4oo7xj"></script> <style>
        :root { --gold: #FFD700; --bg: #0b0b0b; --card: #151515; }
        body { font-family: 'Segoe UI', Roboto, sans-serif; background: var(--bg); color: white; margin: 0; padding-bottom: 80px; }
        .container { max-width: 480px; margin: auto; padding: 20px; }
        
        /* Header & Balance */
        .header { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid #222; }
        .balance-card { background: linear-gradient(145deg, #1a1a1a, #000); padding: 35px 20px; border-radius: 24px; text-align: center; margin: 20px 0; border: 1px solid #333; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .balance-amount { font-size: 3rem; font-weight: 800; color: var(--gold); }

        /* Task List */
        .section-title { font-size: 0.8rem; color: #666; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 15px; }
        .bundle-box { background: var(--card); border-radius: 18px; padding: 20px; margin-bottom: 15px; border: 1px solid #222; transition: 0.3s; }
        .bundle-box:active { transform: scale(0.98); background: #1a1a1a; }
        
        /* Sub-Task Styles */
        .sub-task-row { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid #222; }
        .sub-task-row:last-child { border-bottom: none; }
        .btn-start { background: var(--gold); color: black; border: none; padding: 8px 16px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .btn-start.completed { background: #4CAF50; color: white; }

        /* Navigation */
        .nav { position: fixed; bottom: 0; width: 100%; background: #111; display: flex; justify-content: space-around; padding: 15px 0; border-top: 1px solid #222; z-index: 1000; }
        .nav-item { color: #555; text-align: center; font-size: 0.7rem; }
        .nav-item.active { color: var(--gold); }

        .page { display: none; animation: slideUp 0.3s ease; }
        .page.active { display: block; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        .hidden { display: none !important; }
        input { width: 100%; padding: 15px; margin-bottom: 15px; border-radius: 12px; border: 1px solid #333; background: #1a1a1a; color: white; }
    </style>
</head>
<body>

    <div id="auth-page" class="container" style="padding-top: 100px; text-align: center;">
        <h1 style="color:var(--gold); font-size: 2.5rem;">Theophos</h1>
        <p style="color:#666;">Enter your details to start earning</p>
        <input type="email" id="email" placeholder="Email Address">
        <input type="password" id="password" placeholder="Account Password">
        <button onclick="handleAuth()" style="width:100%; padding:18px; background:var(--gold); border:none; border-radius:12px; font-weight:bold; font-size:1rem;">Access Dashboard</button>
    </div>

    <div id="app-content" class="hidden">
        
        <div id="home-page" class="page active container">
            <div class="header">
                <span style="font-weight:900; color:var(--gold);">THEOPHOS AI</span>
                <span id="user-id" style="font-size:0.7rem; color:#444;">ID: #------</span>
            </div>

            <div class="balance-card">
                <small style="color:#666;">EARNED POINTS</small>
                <div class="balance-amount" id="pts-display">0</div>
            </div>

            <div class="section-title">Available Task Bundles</div>
            
            <div class="bundle-box" onclick="openBundle('ogads')">
                <div style="font-weight:bold;">Task 1: OGAds Bundle</div>
                <div style="font-size:0.8rem; color:#666;">Verify with 3 different actions</div>
                <div style="color:var(--gold); font-size:0.8rem; margin-top:10px;">Reward: +40 Pts</div>
            </div>

            <div class="bundle-box" onclick="openBundle('cpagrip')">
                <div style="font-weight:bold;">Task 2: CPAGrip Bundle</div>
                <div style="font-size:0.8rem; color:#666;">Watch and unlock premium content</div>
                <div style="color:var(--gold); font-size:0.8rem; margin-top:10px;">Reward: +40 Pts</div>
            </div>
        </div>

        <div id="task-page" class="page container">
            <button onclick="showPage('home-page')" style="background:none; border:none; color:var(--gold); margin: 20px 0;">‚Üê Back to Home</button>
            <h2 id="bundle-title">Network Bundle</h2>
            
            <div id="sub-task-container"></div>
            
            <div id="captcha-area" class="hidden" style="margin-top:20px;">
                <div class="section-title">Security Check</div>
                <div data-captcha-enable="true"></div>
            </div>

            <button id="claim-btn" class="hidden" onclick="claimPoints()" style="width:100%; padding:20px; background:#4CAF50; color:white; border:none; border-radius:15px; font-weight:bold; margin-top:30px;">CLAIM BUNDLE POINTS</button>
        </div>

        <div class="nav">
            <div class="nav-item active" onclick="showPage('home-page')">üè†<br>Home</div>
            <div class="nav-item" onclick="alert('Wallet opens at 1,000 points')">üí∞<br>Wallet</div>
        </div>
    </div>

    <div class="hidden">
        <script type="text/javascript" src="https://playabledownload.com/script_include.php?id=1866349"></script>
        <script type="text/javascript" src="https://playabledownload.com/script_include.php?id=1866355"></script>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc, updateDoc, onSnapshot, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDphx9VNL7zycGOofDyDyY688pggYl4mns",
            authDomain: "theophos-rewards-system.firebaseapp.com",
            projectId: "theophos-rewards-system",
            storageBucket: "theophos-rewards-system.firebasestorage.app",
            messagingSenderId: "669378222",
            appId: "1:669378222:web:4a295fab14a09ff3662f3f"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        let currentUser = null;
        let tasksDone = 0;

        const bundles = {
            ogads: {
                title: "OGAds Network",
                points: 40,
                tasks: [
                    { name: "Verify with Content Locker", action: () => { call_locker(); markTask(0); } },
                    { name: "Unlock via OGAds Smartlink", action: () => { window.open('https://lockedapp.org/sl/n1xyw'); markTask(1); } },
                    { name: "Complete Captcha Below", action: () => { markTask(2); } }
                ]
            },
            cpagrip: {
                title: "CPAGrip Network",
                points: 40,
                tasks: [
                    { name: "Play Video Reward", action: () => { load_locker(); markTask(0); } },
                    { name: "Check CPAGrip Offer", action: () => { /* 1866355 trigger */ markTask(1); } },
                    { name: "Smartlink Discovery", action: () => { window.open('https://playabledownload.com/1866359'); markTask(2); } }
                ]
            }
        };

        window.showPage = (id) => {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        };

        window.handleAuth = async () => {
            const email = document.getElementById('email').value.toLowerCase().trim();
            const pass = document.getElementById('password').value;
            if(!email || !pass) return alert("Please fill both fields");

            const userRef = doc(db, "users", email);
            const snap = await getDoc(userRef);

            if(snap.exists()) {
                if(snap.data().password === pass) login(email);
                else alert("Incorrect Password");
            } else {
                await setDoc(userRef, { email, password: pass, points: 0, userId: Math.floor(100000 + Math.random()*900000) });
                login(email);
            }
        };

        function login(email) {
            currentUser = email;
            document.getElementById('auth-page').classList.add('hidden');
            document.getElementById('app-content').classList.remove('hidden');
            
            onSnapshot(doc(db, "users", email), (doc) => {
                document.getElementById('pts-display').innerText = doc.data().points;
                document.getElementById('user-id').innerText = "ID: #" + doc.data().userId;
            });
        }

        window.openBundle = (key) => {
            tasksDone = 0;
            const bundle = bundles[key];
            document.getElementById('bundle-title').innerText = bundle.title;
            const container = document.getElementById('sub-task-container');
            container.innerHTML = "";
            
            bundle.tasks.forEach((t, i) => {
                const row = document.createElement('div');
                row.className = "sub-task-row";
                row.innerHTML = `<span>${t.name}</span><button class="btn-start" id="tbtn-${i}" onclick="runTask('${key}', ${i})">Start</button>`;
                container.appendChild(row);
            });

            if(key === 'ogads') document.getElementById('captcha-area').classList.remove('hidden');
            else document.getElementById('captcha-area').classList.add('hidden');

            document.getElementById('claim-btn').classList.add('hidden');
            showPage('task-page');
            window.activeBundleKey = key;
        };

        window.runTask = (key, index) => {
            bundles[key].tasks[index].action();
        };

        function markTask(index) {
            const btn = document.getElementById(`tbtn-${index}`);
            if(btn && !btn.classList.contains('completed')) {
                btn.classList.add('completed');
                btn.innerText = "‚úÖ Done";
                tasksDone++;
                if(tasksDone >= 3) document.getElementById('claim-btn').classList.remove('hidden');
            }
        }

        window.claimPoints = async () => {
            const bundleKey = window.activeBundleKey;
            const pts = bundles[bundleKey].points;
            await updateDoc(doc(db, "users", currentUser), { points: increment(pts) });
            alert("Bundle Complete! Points Added.");
            showPage('home-page');
        };

        // Network Callbacks (Auto-points if the user finishes the actual locker)
        window.ogads_complete = () => { if(currentUser) updateDoc(doc(db, "users", currentUser), { points: increment(15) }); };
    </script>
</body>
</html>
